	include p18f452.inc
	include "test.h"
; ************************************************************************
;	RESET VECTOR
; ************************************************************************
 	ORG 0x00
	bra Pentry
; ************************************************************************
	include intvect1.inc
; ************************************************************************
;	I/O CONFIGURATION	
; ************************************************************************
Pentry	movlw 0xFE
	movwf TRISC		; RC0 - ?????, ????????? - ?????
; ************************************************************************
;	GENERAL INITIALISATION
; ************************************************************************
	bcf INTCON2,NOT_RBPU	; ???????? ????????????? ????????? ?? ???? ?
	movlw Period
	movwf Count		; ????????? ???????
	clrf paus
	movlw 0xFF
	movwf PR2
	bsf PIE1,TMR2IE		; ????????? ?????????? ?? ??????? 2
	movlw 0xC0
	movwf INTCON		; ????????? ?????????? ????????? ? ???????????? ??????????
; ************************************************************************
; 	Start waiting loop
; ************************************************************************
Wentry	btfsc BUTTON		; ??????? ???????
	bra $-2
	rcall Pause
	btfsc BUTTON
	bra Wentry
	btfss BUTTON		; ??????? ??????????
	bra $-2
	rcall Pause
	btfss BUTTON
	bra $-10
;
	bsf FIRE		; ?????? ????????
	bsf T2CON,TMR2ON	; ????????? ???????
	movlw 0x7F
	movwf T2CON

	bra Wentry
; ************************************************************************
Pause	nop
	decfsz paus
	bra Pause
	decfsz Count
	bra Pause
	movlw 0x3
	movlw Countb
	return
; ************************************************************************
	END
